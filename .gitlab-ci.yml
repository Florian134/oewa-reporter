# Ã–WA Reporter - GitLab CI/CD Pipeline
# =====================================
# Triggered by Airtable Automations or GitLab Schedules

stages:
  - run

variables:
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"

# Cache fÃ¼r schnellere Builds
cache:
  paths:
    - .cache/pip/

# =============================================================================
# DAILY INGESTION - Standard Job (wird bei jedem Trigger ausgefÃ¼hrt)
# =============================================================================
daily_ingest:
  stage: run
  image: python:3.11-slim
  script:
    - echo "ðŸš€ Ã–WA Reporter - Daily Ingestion"
    - pip install --upgrade pip
    - pip install requests python-dotenv openai
    - python ci_scripts/daily_ingest.py
    - echo "âœ… Daily Ingestion completed!"
  rules:
    - if: $CI_PIPELINE_SOURCE == "trigger"
    - if: $CI_PIPELINE_SOURCE == "schedule"
    - if: $CI_PIPELINE_SOURCE == "web"
